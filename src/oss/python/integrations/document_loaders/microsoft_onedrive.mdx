---
title: Microsoft OneDrive
---

>[Microsoft OneDrive](https://en.wikipedia.org/wiki/OneDrive) (ì´ì „ ëª…ì¹­ `SkyDrive`)ëŠ” Microsoftì—ì„œ ìš´ì˜í•˜ëŠ” íŒŒì¼ í˜¸ìŠ¤íŒ… ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤.

ì´ ë…¸íŠ¸ë¶ì€ `OneDrive`ì—ì„œ ë¬¸ì„œë¥¼ ë¡œë“œí•˜ëŠ” ë°©ë²•ì„ ë‹¤ë£¹ë‹ˆë‹¤. ê¸°ë³¸ì ìœ¼ë¡œ document loaderëŠ” `pdf`, `doc`, `docx`, `txt` íŒŒì¼ì„ ë¡œë“œí•©ë‹ˆë‹¤. ì ì ˆí•œ parserë¥¼ ì œê³µí•˜ì—¬ ë‹¤ë¥¸ íŒŒì¼ í˜•ì‹ì„ ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤(ì•„ë˜ ì°¸ì¡°).

## Prerequisites

1. [Microsoft identity platform](https://learn.microsoft.com/en-us/azure/active-directory/develop/quickstart-register-app) ì§€ì¹¨ì— ë”°ë¼ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë“±ë¡í•©ë‹ˆë‹¤.
2. ë“±ë¡ì´ ì™„ë£Œë˜ë©´ Azure portalì— ì•± ë“±ë¡ì˜ Overview ì°½ì´ í‘œì‹œë©ë‹ˆë‹¤. Application (client) IDê°€ í‘œì‹œë©ë‹ˆë‹¤. `client ID`ë¼ê³ ë„ í•˜ëŠ” ì´ ê°’ì€ Microsoft identity platformì—ì„œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ê³ ìœ í•˜ê²Œ ì‹ë³„í•©ë‹ˆë‹¤.
3. **í•­ëª© 1**ì—ì„œ ìˆ˜í–‰í•  ë‹¨ê³„ ì¤‘ì— redirect URIë¥¼ `http://localhost:8000/callback`ìœ¼ë¡œ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
4. **í•­ëª© 1**ì—ì„œ ìˆ˜í–‰í•  ë‹¨ê³„ ì¤‘ì— Application Secrets ì„¹ì…˜ì—ì„œ ìƒˆ password(`client_secret`)ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
5. ì´ [ë¬¸ì„œ](https://learn.microsoft.com/en-us/azure/active-directory/develop/quickstart-configure-app-expose-web-apis#add-a-scope)ì˜ ì§€ì¹¨ì— ë”°ë¼ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ë‹¤ìŒ `SCOPES`(`offline_access` ë° `Files.Read.All`)ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.
6. [Graph Explorer Playground](https://developer.microsoft.com/en-us/graph/graph-explorer)ë¥¼ ë°©ë¬¸í•˜ì—¬ `OneDrive ID`ë¥¼ ì–»ìŠµë‹ˆë‹¤. ì²« ë²ˆì§¸ ë‹¨ê³„ëŠ” OneDrive ê³„ì •ê³¼ ì—°ê²°ëœ ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸í–ˆëŠ”ì§€ í™•ì¸í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ `https://graph.microsoft.com/v1.0/me/drive`ì— ìš”ì²­ì„ ë³´ë‚´ì•¼ í•˜ë©°, ì‘ë‹µì€ OneDrive ê³„ì •ì˜ IDë¥¼ í¬í•¨í•˜ëŠ” `id` í•„ë“œê°€ ìˆëŠ” payloadë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.
7. `pip install o365` ëª…ë ¹ì„ ì‚¬ìš©í•˜ì—¬ o365 packageë¥¼ ì„¤ì¹˜í•´ì•¼ í•©ë‹ˆë‹¤.
8. ë‹¨ê³„ê°€ ëë‚˜ë©´ ë‹¤ìŒ ê°’ë“¤ì„ ê°€ì§€ê³  ìˆì–´ì•¼ í•©ë‹ˆë‹¤:

- `CLIENT_ID`
- `CLIENT_SECRET`
- `DRIVE_ID`

## ğŸ§‘ OneDriveì—ì„œ ë¬¸ì„œë¥¼ ìˆ˜ì§‘í•˜ê¸° ìœ„í•œ ì§€ì¹¨

### ğŸ”‘ Authentication

ê¸°ë³¸ì ìœ¼ë¡œ `OneDriveLoader`ëŠ” `CLIENT_ID`ì™€ `CLIENT_SECRET` ê°’ì´ ê°ê° `O365_CLIENT_ID`ì™€ `O365_CLIENT_SECRET`ë¼ëŠ” ì´ë¦„ì˜ environment variableë¡œ ì €ì¥ë˜ì–´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤. ì• í”Œë¦¬ì¼€ì´ì…˜ ë£¨íŠ¸ì— ìˆëŠ” `.env` íŒŒì¼ì„ í†µí•´ ë˜ëŠ” ìŠ¤í¬ë¦½íŠ¸ì—ì„œ ë‹¤ìŒ ëª…ë ¹ì„ ì‚¬ìš©í•˜ì—¬ ì´ëŸ¬í•œ environment variableì„ ì „ë‹¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```python
os.environ['O365_CLIENT_ID'] = "YOUR CLIENT ID"
os.environ['O365_CLIENT_SECRET'] = "YOUR CLIENT SECRET"
```

ì´ loaderëŠ” [*on behalf of a user*](https://learn.microsoft.com/en-us/graph/auth-v2-user?context=graph%2Fapi%2F1.0&view=graph-rest-1.0)ë¼ëŠ” authenticationì„ ì‚¬ìš©í•©ë‹ˆë‹¤. ì‚¬ìš©ì ë™ì˜ê°€ í•„ìš”í•œ 2ë‹¨ê³„ authenticationì…ë‹ˆë‹¤. loaderë¥¼ ì¸ìŠ¤í„´ìŠ¤í™”í•˜ë©´ ì‚¬ìš©ìê°€ í•„ìš”í•œ ê¶Œí•œì— ëŒ€í•´ ì•±ì— ë™ì˜í•˜ê¸° ìœ„í•´ ë°©ë¬¸í•´ì•¼ í•˜ëŠ” urlì„ ì¶œë ¥í•©ë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ ì‚¬ìš©ìëŠ” ì´ urlì„ ë°©ë¬¸í•˜ì—¬ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ë™ì˜í•´ì•¼ í•©ë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ ì‚¬ìš©ìëŠ” ê²°ê³¼ í˜ì´ì§€ urlì„ ë³µì‚¬í•˜ì—¬ ì½˜ì†”ì— ë‹¤ì‹œ ë¶™ì—¬ë„£ì–´ì•¼ í•©ë‹ˆë‹¤. ê·¸ëŸ¬ë©´ ë©”ì„œë“œëŠ” ë¡œê·¸ì¸ ì‹œë„ê°€ ì„±ê³µí–ˆì„ ê²½ìš° Trueë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.

```python
from langchain_community.document_loaders.onedrive import OneDriveLoader

loader = OneDriveLoader(drive_id="YOUR DRIVE ID")
```

authenticationì´ ì™„ë£Œë˜ë©´ loaderëŠ” `~/.credentials/` í´ë”ì— token(`o365_token.txt`)ì„ ì €ì¥í•©ë‹ˆë‹¤. ì´ tokenì€ ë‚˜ì¤‘ì— ì•ì„œ ì„¤ëª…í•œ ë³µì‚¬/ë¶™ì—¬ë„£ê¸° ë‹¨ê³„ ì—†ì´ authenticationí•˜ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ tokenì„ authenticationì— ì‚¬ìš©í•˜ë ¤ë©´ loaderë¥¼ ì¸ìŠ¤í„´ìŠ¤í™”í•  ë•Œ `auth_with_token` parameterë¥¼ Trueë¡œ ë³€ê²½í•´ì•¼ í•©ë‹ˆë‹¤.

```python
from langchain_community.document_loaders.onedrive import OneDriveLoader

loader = OneDriveLoader(drive_id="YOUR DRIVE ID", auth_with_token=True)
```

### ğŸ—‚ï¸ Documents loader

#### ğŸ“‘ OneDrive Directoryì—ì„œ ë¬¸ì„œ ë¡œë“œí•˜ê¸°

`OneDriveLoader`ëŠ” OneDrive ë‚´ì˜ íŠ¹ì • í´ë”ì—ì„œ ë¬¸ì„œë¥¼ ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, OneDrive ë‚´ì˜ `Documents/clients` í´ë”ì— ì €ì¥ëœ ëª¨ë“  ë¬¸ì„œë¥¼ ë¡œë“œí•˜ë ¤ê³  í•©ë‹ˆë‹¤.

```python
from langchain_community.document_loaders.onedrive import OneDriveLoader

loader = OneDriveLoader(drive_id="YOUR DRIVE ID", folder_path="Documents/clients", auth_with_token=True)
documents = loader.load()
```

#### ğŸ“‘ Documents ID ëª©ë¡ì—ì„œ ë¬¸ì„œ ë¡œë“œí•˜ê¸°

ë˜ ë‹¤ë¥¸ ë°©ë²•ì€ ë¡œë“œí•˜ë ¤ëŠ” ê° ë¬¸ì„œì— ëŒ€í•œ `object_id` ëª©ë¡ì„ ì œê³µí•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ì´ë¥¼ ìœ„í•´ì„œëŠ” [Microsoft Graph API](https://developer.microsoft.com/en-us/graph/graph-explorer)ë¥¼ ì¿¼ë¦¬í•˜ì—¬ ê´€ì‹¬ ìˆëŠ” ëª¨ë“  ë¬¸ì„œ IDë¥¼ ì°¾ì•„ì•¼ í•©ë‹ˆë‹¤. ì´ [ë§í¬](https://learn.microsoft.com/en-us/graph/api/resources/onedrive?view=graph-rest-1.0#commonly-accessed-resources)ëŠ” ë¬¸ì„œ IDë¥¼ ê²€ìƒ‰í•˜ëŠ” ë° ë„ì›€ì´ ë˜ëŠ” endpoint ëª©ë¡ì„ ì œê³µí•©ë‹ˆë‹¤.

ì˜ˆë¥¼ ë“¤ì–´, Documents í´ë”ì˜ ë£¨íŠ¸ì— ì €ì¥ëœ ëª¨ë“  ê°ì²´ì— ëŒ€í•œ ì •ë³´ë¥¼ ê²€ìƒ‰í•˜ë ¤ë©´ `https://graph.microsoft.com/v1.0/drives/{YOUR DRIVE ID}/root/children`ì— ìš”ì²­ì„ ë³´ë‚´ì•¼ í•©ë‹ˆë‹¤. ê´€ì‹¬ ìˆëŠ” ID ëª©ë¡ì„ ì–»ìœ¼ë©´ ë‹¤ìŒ parameterë¡œ loaderë¥¼ ì¸ìŠ¤í„´ìŠ¤í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```python
from langchain_community.document_loaders.onedrive import OneDriveLoader

loader = OneDriveLoader(drive_id="YOUR DRIVE ID", object_ids=["ID_1", "ID_2"], auth_with_token=True)
documents = loader.load()
```

#### ğŸ“‘ ì§€ì›ë˜ëŠ” íŒŒì¼ í˜•ì‹ ë° ì„ í˜¸í•˜ëŠ” parser ì„ íƒí•˜ê¸°

ê¸°ë³¸ì ìœ¼ë¡œ `OneDriveLoader`ëŠ” ê¸°ë³¸ parserë¥¼ ì‚¬ìš©í•˜ì—¬ [`document_loaders/parsers/registry`](https://github.com/langchain-ai/langchain/blob/master/libs/community/langchain_community/document_loaders/parsers/registry.py#L10-L22)ì— ì •ì˜ëœ íŒŒì¼ í˜•ì‹ì„ ë¡œë“œí•©ë‹ˆë‹¤(ì•„ë˜ ì°¸ì¡°).

```python
def _get_default_parser() -> BaseBlobParser:
    """Get default mime-type based parser."""
    return MimeTypeBasedParser(
        handlers={
            "application/pdf": PyMuPDFParser(),
            "text/plain": TextParser(),
            "application/msword": MsWordParser(),
            "application/vnd.openxmlformats-officedocument.wordprocessingml.document": (
                MsWordParser()
            ),
        },
        fallback_parser=None,
    )
```

`OneDriveLoader`ì— `handlers` argumentë¥¼ ì „ë‹¬í•˜ì—¬ ì´ ë™ì‘ì„ ì¬ì •ì˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
íŒŒì¼ í™•ì¥ì(`"doc"`, `"pdf"` ë“±) ë˜ëŠ” MIME type(`"application/pdf"`, `"text/plain"` ë“±)ì„ parserì— ë§¤í•‘í•˜ëŠ” dictionaryë¥¼ ì „ë‹¬í•©ë‹ˆë‹¤.
íŒŒì¼ í™•ì¥ì ë˜ëŠ” MIME type ì¤‘ í•˜ë‚˜ë§Œ ì‚¬ìš©í•´ì•¼ í•˜ë©°
í˜¼í•©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.

íŒŒì¼ í™•ì¥ìì—ëŠ” ì•ì˜ ì ì„ í¬í•¨í•˜ì§€ ë§ˆì„¸ìš”.

```python
# using file extensions:
handlers = {
    "doc": MsWordParser(),
    "pdf": PDFMinerParser(),
    "mp3": OpenAIWhisperParser()
}

# using MIME types:
handlers = {
    "application/msword": MsWordParser(),
    "application/pdf": PDFMinerParser(),
    "audio/mpeg": OpenAIWhisperParser()
}

loader = OneDriveLoader(document_library_id="...",
                            handlers=handlers # pass handlers to OneDriveLoader
                            )
```

ì—¬ëŸ¬ íŒŒì¼ í™•ì¥ìê°€ ë™ì¼í•œ MIME typeì— ë§¤í•‘ë˜ëŠ” ê²½ìš° ë§ˆì§€ë§‰ dictionary í•­ëª©ì´
ì ìš©ë©ë‹ˆë‹¤.
ì˜ˆì‹œ:

```python
# 'jpg' and 'jpeg' both map to 'image/jpeg' MIME type. SecondParser() will be used
# to parse all jpg/jpeg files.
handlers = {
    "jpg": FirstParser(),
    "jpeg": SecondParser()
}
```