---
title: Microsoft SharePoint
---

> [Microsoft SharePoint](https://en.wikipedia.org/wiki/SharePoint)ëŠ” Microsoftì—ì„œ ê°œë°œí•œ ì›¹ì‚¬ì´íŠ¸ ê¸°ë°˜ í˜‘ì—… ì‹œìŠ¤í…œìœ¼ë¡œ, ì›Œí¬í”Œë¡œìš° ì• í”Œë¦¬ì¼€ì´ì…˜, "list" ë°ì´í„°ë² ì´ìŠ¤, ê¸°íƒ€ ì›¹ íŒŒíŠ¸ ë° ë³´ì•ˆ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ì—¬ ë¹„ì¦ˆë‹ˆìŠ¤ íŒ€ì´ í•¨ê»˜ ì‘ì—…í•  ìˆ˜ ìˆë„ë¡ ì§€ì›í•©ë‹ˆë‹¤.

ì´ ë…¸íŠ¸ë¶ì€ [SharePoint Document Library](https://support.microsoft.com/en-us/office/what-is-a-document-library-3b5976dd-65cf-4c9e-bf5a-713c10ca2872)ì—ì„œ ë¬¸ì„œë¥¼ ë¡œë“œí•˜ëŠ” ë°©ë²•ì„ ë‹¤ë£¹ë‹ˆë‹¤. ê¸°ë³¸ì ìœ¼ë¡œ document loaderëŠ” `pdf`, `doc`, `docx` ë° `txt` íŒŒì¼ì„ ë¡œë“œí•©ë‹ˆë‹¤. ì ì ˆí•œ parserë¥¼ ì œê³µí•˜ì—¬ ë‹¤ë¥¸ íŒŒì¼ ìœ í˜•ì„ ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤(ì•„ë˜ ì°¸ì¡°).

## Prerequisites

1. [Microsoft identity platform](https://learn.microsoft.com/en-us/azure/active-directory/develop/quickstart-register-app) ì§€ì¹¨ì— ë”°ë¼ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë“±ë¡í•©ë‹ˆë‹¤.
2. ë“±ë¡ì´ ì™„ë£Œë˜ë©´ Azure portalì— ì•± ë“±ë¡ì˜ Overview ì°½ì´ í‘œì‹œë©ë‹ˆë‹¤. Application (client) IDê°€ í‘œì‹œë©ë‹ˆë‹¤. `client ID`ë¼ê³ ë„ í•˜ëŠ” ì´ ê°’ì€ Microsoft identity platformì—ì„œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ê³ ìœ í•˜ê²Œ ì‹ë³„í•©ë‹ˆë‹¤.
3. **í•­ëª© 1**ì—ì„œ ìˆ˜í–‰í•  ë‹¨ê³„ ì¤‘ì— redirect URIë¥¼ `https://login.microsoftonline.com/common/oauth2/nativeclient`ë¡œ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
4. **í•­ëª© 1**ì—ì„œ ìˆ˜í–‰í•  ë‹¨ê³„ ì¤‘ì— Application Secrets ì„¹ì…˜ì—ì„œ ìƒˆ password(`client_secret`)ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
5. ì´ [ë¬¸ì„œ](https://learn.microsoft.com/en-us/azure/active-directory/develop/quickstart-configure-app-expose-web-apis#add-a-scope)ì˜ ì§€ì¹¨ì— ë”°ë¼ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ë‹¤ìŒ `SCOPES`(`offline_access` ë° `Sites.Read.All`)ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.
6. **Document Library**ì—ì„œ íŒŒì¼ì„ ê²€ìƒ‰í•˜ë ¤ë©´ í•´ë‹¹ IDê°€ í•„ìš”í•©ë‹ˆë‹¤. ì´ë¥¼ ì–»ìœ¼ë ¤ë©´ `Tenant Name`, `Collection ID` ë° `Subsite ID` ê°’ì´ í•„ìš”í•©ë‹ˆë‹¤.
7. `Tenant Name`ì„ ì°¾ìœ¼ë ¤ë©´ ì´ [ë¬¸ì„œ](https://learn.microsoft.com/en-us/azure/active-directory-b2c/tenant-management-read-tenant-name)ì˜ ì§€ì¹¨ì„ ë”°ë¥´ì„¸ìš”. ì´ë¥¼ ì–»ì€ í›„ ê°’ì—ì„œ `.onmicrosoft.com`ì„ ì œê±°í•˜ê³  ë‚˜ë¨¸ì§€ë¥¼ `Tenant Name`ìœ¼ë¡œ ë³´ê´€í•©ë‹ˆë‹¤.
8. `Collection ID`ì™€ `Subsite ID`ë¥¼ ì–»ìœ¼ë ¤ë©´ **SharePoint** `site-name`ì´ í•„ìš”í•©ë‹ˆë‹¤. **SharePoint** site URLì€ ë‹¤ìŒ í˜•ì‹ì„ ê°–ìŠµë‹ˆë‹¤: `https://<tenant-name>.sharepoint.com/sites/<site-name>`. ì´ URLì˜ ë§ˆì§€ë§‰ ë¶€ë¶„ì´ `site-name`ì…ë‹ˆë‹¤.
9. Site `Collection ID`ë¥¼ ì–»ìœ¼ë ¤ë©´ ë¸Œë¼ìš°ì €ì—ì„œ ë‹¤ìŒ URLì„ ë°©ë¬¸í•˜ì„¸ìš”: `https://<tenant>.sharepoint.com/sites/<site-name>/_api/site/id` ê·¸ë¦¬ê³  `Edm.Guid` ì†ì„±ì˜ ê°’ì„ ë³µì‚¬í•©ë‹ˆë‹¤.
10. `Subsite ID`(ë˜ëŠ” web ID)ë¥¼ ì–»ìœ¼ë ¤ë©´ ë‹¤ìŒì„ ì‚¬ìš©í•˜ì„¸ìš”: `https://<tenant>.sharepoint.com/sites/<site-name>/_api/web/id` ê·¸ë¦¬ê³  `Edm.Guid` ì†ì„±ì˜ ê°’ì„ ë³µì‚¬í•©ë‹ˆë‹¤.
11. `SharePoint site ID`ëŠ” ë‹¤ìŒ í˜•ì‹ì„ ê°–ìŠµë‹ˆë‹¤: `<tenant-name>.sharepoint.com,<Collection ID>,<subsite ID>`. ì´ ê°’ì„ ë‹¤ìŒ ë‹¨ê³„ì—ì„œ ì‚¬ìš©í•˜ê¸° ìœ„í•´ ë³´ê´€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
12. [Graph Explorer Playground](https://developer.microsoft.com/en-us/graph/graph-explorer)ë¥¼ ë°©ë¬¸í•˜ì—¬ `Document Library ID`ë¥¼ ì–»ìŠµë‹ˆë‹¤. ì²« ë²ˆì§¸ ë‹¨ê³„ëŠ” **SharePoint** ì‚¬ì´íŠ¸ì™€ ì—°ê²°ëœ ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ `https://graph.microsoft.com/v1.0/sites/<SharePoint site ID>/drive`ì— ìš”ì²­ì„ í•´ì•¼ í•˜ë©°, ì‘ë‹µì€ `Document Library ID`ì˜ IDë¥¼ í¬í•¨í•˜ëŠ” `id` í•„ë“œê°€ ìˆëŠ” payloadë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.

## ğŸ§‘ SharePoint Document Libraryì—ì„œ ë¬¸ì„œë¥¼ ìˆ˜ì§‘í•˜ê¸° ìœ„í•œ ì§€ì¹¨

### ğŸ”‘ Authentication

ê¸°ë³¸ì ìœ¼ë¡œ `SharePointLoader`ëŠ” `CLIENT_ID`ì™€ `CLIENT_SECRET` ê°’ì´ ê°ê° `O365_CLIENT_ID`ì™€ `O365_CLIENT_SECRET`ë¼ëŠ” ì´ë¦„ì˜ í™˜ê²½ ë³€ìˆ˜ë¡œ ì €ì¥ë˜ì–´ì•¼ í•©ë‹ˆë‹¤. ì• í”Œë¦¬ì¼€ì´ì…˜ ë£¨íŠ¸ì— `.env` íŒŒì¼ì„ í†µí•´ ë˜ëŠ” ìŠ¤í¬ë¦½íŠ¸ì—ì„œ ë‹¤ìŒ ëª…ë ¹ì„ ì‚¬ìš©í•˜ì—¬ ì´ëŸ¬í•œ í™˜ê²½ ë³€ìˆ˜ë¥¼ ì „ë‹¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```python
os.environ['O365_CLIENT_ID'] = "YOUR CLIENT ID"
os.environ['O365_CLIENT_SECRET'] = "YOUR CLIENT SECRET"
```

ì´ loaderëŠ” [*on behalf of a user*](https://learn.microsoft.com/en-us/graph/auth-v2-user?context=graph%2Fapi%2F1.0&view=graph-rest-1.0)ë¼ëŠ” ì¸ì¦ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. ì‚¬ìš©ì ë™ì˜ê°€ í•„ìš”í•œ 2ë‹¨ê³„ ì¸ì¦ì…ë‹ˆë‹¤. loaderë¥¼ ì¸ìŠ¤í„´ìŠ¤í™”í•˜ë©´ ì‚¬ìš©ìê°€ í•„ìš”í•œ ê¶Œí•œì— ëŒ€í•´ ì•±ì— ë™ì˜í•˜ê¸° ìœ„í•´ ë°©ë¬¸í•´ì•¼ í•˜ëŠ” urlì„ ì¶œë ¥í•©ë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ ì‚¬ìš©ìëŠ” ì´ urlì„ ë°©ë¬¸í•˜ì—¬ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ë™ì˜í•´ì•¼ í•©ë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ ì‚¬ìš©ìëŠ” ê²°ê³¼ í˜ì´ì§€ urlì„ ë³µì‚¬í•˜ì—¬ ì½˜ì†”ì— ë‹¤ì‹œ ë¶™ì—¬ë„£ì–´ì•¼ í•©ë‹ˆë‹¤. ê·¸ëŸ¬ë©´ ë¡œê·¸ì¸ ì‹œë„ê°€ ì„±ê³µí•œ ê²½ìš° ë©”ì„œë“œê°€ Trueë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.

```python
from langchain_community.document_loaders.sharepoint import SharePointLoader

loader = SharePointLoader(document_library_id="YOUR DOCUMENT LIBRARY ID")
```

ì¸ì¦ì´ ì™„ë£Œë˜ë©´ loaderëŠ” `~/.credentials/` í´ë”ì— token(`o365_token.txt`)ì„ ì €ì¥í•©ë‹ˆë‹¤. ì´ tokenì€ ë‚˜ì¤‘ì— ì•ì„œ ì„¤ëª…í•œ ë³µì‚¬/ë¶™ì—¬ë„£ê¸° ë‹¨ê³„ ì—†ì´ ì¸ì¦í•˜ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì¸ì¦ì— ì´ tokenì„ ì‚¬ìš©í•˜ë ¤ë©´ loader ì¸ìŠ¤í„´ìŠ¤í™” ì‹œ `auth_with_token` ë§¤ê°œë³€ìˆ˜ë¥¼ Trueë¡œ ë³€ê²½í•´ì•¼ í•©ë‹ˆë‹¤.

```python
from langchain_community.document_loaders.sharepoint import SharePointLoader

loader = SharePointLoader(document_library_id="YOUR DOCUMENT LIBRARY ID", auth_with_token=True)
```

### ğŸ—‚ï¸ Documents loader

#### ğŸ“‘ Document Library Directoryì—ì„œ ë¬¸ì„œ ë¡œë“œí•˜ê¸°

`SharePointLoader`ëŠ” Document Library ë‚´ì˜ íŠ¹ì • í´ë”ì—ì„œ ë¬¸ì„œë¥¼ ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, Document Library ë‚´ì˜ `Documents/marketing` í´ë”ì— ì €ì¥ëœ ëª¨ë“  ë¬¸ì„œë¥¼ ë¡œë“œí•˜ë ¤ëŠ” ê²½ìš°ì…ë‹ˆë‹¤.

```python
from langchain_community.document_loaders.sharepoint import SharePointLoader

loader = SharePointLoader(document_library_id="YOUR DOCUMENT LIBRARY ID", folder_path="Documents/marketing", auth_with_token=True)
documents = loader.load()
```

`Resource not found for the segment` ì˜¤ë¥˜ê°€ ë°œìƒí•˜ëŠ” ê²½ìš°, [Microsoft Graph API](https://developer.microsoft.com/en-us/graph/graph-explorer)ì—ì„œ ì–»ì„ ìˆ˜ ìˆëŠ” `folder_id`ë¥¼ folder path ëŒ€ì‹  ì‚¬ìš©í•´ ë³´ì„¸ìš”.

```python
loader = SharePointLoader(document_library_id="YOUR DOCUMENT LIBRARY ID", auth_with_token=True
                          folder_id="<folder-id>")
documents = loader.load()
```

ë£¨íŠ¸ ë””ë ‰í† ë¦¬ì—ì„œ ë¬¸ì„œë¥¼ ë¡œë“œí•˜ë ¤ë©´ `folder_id`, `folder_path` ë° `documents_ids`ë¥¼ ìƒëµí•  ìˆ˜ ìˆìœ¼ë©° loaderê°€ ë£¨íŠ¸ ë””ë ‰í† ë¦¬ë¥¼ ë¡œë“œí•©ë‹ˆë‹¤.

```python
# loads documents from root directory
loader = SharePointLoader(document_library_id="YOUR DOCUMENT LIBRARY ID", auth_with_token=True)
documents = loader.load()
```

`recursive=True`ì™€ ê²°í•©í•˜ë©´ ì „ì²´ SharePointì—ì„œ ëª¨ë“  ë¬¸ì„œë¥¼ ê°„ë‹¨íˆ ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```python
# loads documents from root directory
loader = SharePointLoader(document_library_id="YOUR DOCUMENT LIBRARY ID",
                          recursive=True,
                          auth_with_token=True)
documents = loader.load()
```

#### ğŸ“‘ Documents ID ëª©ë¡ì—ì„œ ë¬¸ì„œ ë¡œë“œí•˜ê¸°

ë˜ ë‹¤ë¥¸ ê°€ëŠ¥ì„±ì€ ë¡œë“œí•˜ë ¤ëŠ” ê° ë¬¸ì„œì— ëŒ€í•œ `object_id` ëª©ë¡ì„ ì œê³µí•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ì´ë¥¼ ìœ„í•´ ê´€ì‹¬ ìˆëŠ” ëª¨ë“  ë¬¸ì„œ IDë¥¼ ì°¾ê¸° ìœ„í•´ [Microsoft Graph API](https://developer.microsoft.com/en-us/graph/graph-explorer)ë¥¼ ì¿¼ë¦¬í•´ì•¼ í•©ë‹ˆë‹¤. ì´ [ë§í¬](https://learn.microsoft.com/en-us/graph/api/resources/onedrive?view=graph-rest-1.0#commonly-accessed-resources)ëŠ” ë¬¸ì„œ IDë¥¼ ê²€ìƒ‰í•˜ëŠ” ë° ë„ì›€ì´ ë˜ëŠ” endpoint ëª©ë¡ì„ ì œê³µí•©ë‹ˆë‹¤.

ì˜ˆë¥¼ ë“¤ì–´, `data/finance/` í´ë”ì— ì €ì¥ëœ ëª¨ë“  ê°ì²´ì— ëŒ€í•œ ì •ë³´ë¥¼ ê²€ìƒ‰í•˜ë ¤ë©´ ë‹¤ìŒì— ìš”ì²­í•´ì•¼ í•©ë‹ˆë‹¤: `https://graph.microsoft.com/v1.0/drives/<document-library-id>/root:/data/finance:/children`. ê´€ì‹¬ ìˆëŠ” ID ëª©ë¡ì„ ì–»ì€ í›„ ë‹¤ìŒ ë§¤ê°œë³€ìˆ˜ë¡œ loaderë¥¼ ì¸ìŠ¤í„´ìŠ¤í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```python
from langchain_community.document_loaders.sharepoint import SharePointLoader

loader = SharePointLoader(document_library_id="YOUR DOCUMENT LIBRARY ID", object_ids=["ID_1", "ID_2"], auth_with_token=True)
documents = loader.load()
```

#### ğŸ“‘ ì§€ì›ë˜ëŠ” íŒŒì¼ ìœ í˜• ë° ì„ í˜¸í•˜ëŠ” parser ì„ íƒí•˜ê¸°

ê¸°ë³¸ì ìœ¼ë¡œ `SharePointLoader`ëŠ” ê¸°ë³¸ parserë¥¼ ì‚¬ìš©í•˜ì—¬ [`document_loaders/parsers/registry`](https://github.com/langchain-ai/langchain/blob/master/libs/community/langchain_community/document_loaders/parsers/registry.py#L10-L22)ì— ì •ì˜ëœ íŒŒì¼ ìœ í˜•ì„ ë¡œë“œí•©ë‹ˆë‹¤(ì•„ë˜ ì°¸ì¡°).

```python
def _get_default_parser() -> BaseBlobParser:
    """Get default mime-type based parser."""
    return MimeTypeBasedParser(
        handlers={
            "application/pdf": PyMuPDFParser(),
            "text/plain": TextParser(),
            "application/msword": MsWordParser(),
            "application/vnd.openxmlformats-officedocument.wordprocessingml.document": (
                MsWordParser()
            ),
        },
        fallback_parser=None,
    )
```

`SharePointLoader`ì— `handlers` ì¸ìˆ˜ë¥¼ ì „ë‹¬í•˜ì—¬ ì´ ë™ì‘ì„ ì¬ì •ì˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
íŒŒì¼ í™•ì¥ì(`"doc"`, `"pdf"` ë“±) ë˜ëŠ” MIME type(`"application/pdf"`, `"text/plain"` ë“±)ì„ parserì— ë§¤í•‘í•˜ëŠ” dictionaryë¥¼ ì „ë‹¬í•˜ì„¸ìš”.
íŒŒì¼ í™•ì¥ì ë˜ëŠ” MIME type ì¤‘ í•˜ë‚˜ë§Œ ë…ì ì ìœ¼ë¡œ ì‚¬ìš©í•´ì•¼ í•˜ë©°
í˜¼í•©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.

íŒŒì¼ í™•ì¥ìì—ëŠ” ì•ì˜ ì ì„ í¬í•¨í•˜ì§€ ë§ˆì„¸ìš”.

```python
# using file extensions:
handlers = {
    "doc": MsWordParser(),
    "pdf": PDFMinerParser(),
    "mp3": OpenAIWhisperParser()
}

# using MIME types:
handlers = {
    "application/msword": MsWordParser(),
    "application/pdf": PDFMinerParser(),
    "audio/mpeg": OpenAIWhisperParser()
}

loader = SharePointLoader(document_library_id="...",
                            handlers=handlers # pass handlers to SharePointLoader
                            )
```

ì—¬ëŸ¬ íŒŒì¼ í™•ì¥ìê°€ ë™ì¼í•œ MIME typeì— ë§¤í•‘ë˜ëŠ” ê²½ìš° ë§ˆì§€ë§‰ dictionary í•­ëª©ì´
ì ìš©ë©ë‹ˆë‹¤.
ì˜ˆì‹œ:

```python
# 'jpg' and 'jpeg' both map to 'image/jpeg' MIME type. SecondParser() will be used
# to parse all jpg/jpeg files.
handlers = {
    "jpg": FirstParser(),
    "jpeg": SecondParser()
}
```