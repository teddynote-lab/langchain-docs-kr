---
title: Microsoft OneNote
---

ì´ ë…¸íŠ¸ë¶ì€ `OneNote`ì—ì„œ ë¬¸ì„œë¥¼ ë¡œë“œí•˜ëŠ” ë°©ë²•ì„ ë‹¤ë£¹ë‹ˆë‹¤.

## ì‚¬ì „ ìš”êµ¬ì‚¬í•­

1. [Microsoft identity platform](https://learn.microsoft.com/en-us/azure/active-directory/develop/quickstart-register-app) ì§€ì¹¨ì— ë”°ë¼ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë“±ë¡í•©ë‹ˆë‹¤.
2. ë“±ë¡ì´ ì™„ë£Œë˜ë©´ Azure portalì— ì•± ë“±ë¡ì˜ ê°œìš” ì°½ì´ í‘œì‹œë©ë‹ˆë‹¤. Application (client) IDê°€ í‘œì‹œë©ë‹ˆë‹¤. `client ID`ë¼ê³ ë„ í•˜ëŠ” ì´ ê°’ì€ Microsoft identity platformì—ì„œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ê³ ìœ í•˜ê²Œ ì‹ë³„í•©ë‹ˆë‹¤.
3. **í•­ëª© 1**ì—ì„œ ìˆ˜í–‰í•  ë‹¨ê³„ ì¤‘ì— redirect URIë¥¼ `http://localhost:8000/callback`ìœ¼ë¡œ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
4. **í•­ëª© 1**ì—ì„œ ìˆ˜í–‰í•  ë‹¨ê³„ ì¤‘ì— Application Secrets ì„¹ì…˜ì—ì„œ ìƒˆ password(`client_secret`)ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
5. ì´ [ë¬¸ì„œ](https://learn.microsoft.com/en-us/azure/active-directory/develop/quickstart-configure-app-expose-web-apis#add-a-scope)ì˜ ì§€ì¹¨ì— ë”°ë¼ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ë‹¤ìŒ `SCOPES`(`Notes.Read`)ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.
6. `pip install msal` ë° `pip install beautifulsoup4` ëª…ë ¹ì„ ì‚¬ìš©í•˜ì—¬ msal ë° bs4 íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•´ì•¼ í•©ë‹ˆë‹¤.
7. ë‹¨ê³„ê°€ ëë‚˜ë©´ ë‹¤ìŒ ê°’ì„ ê°€ì§€ê³  ìˆì–´ì•¼ í•©ë‹ˆë‹¤:

- `CLIENT_ID`
- `CLIENT_SECRET`

## ğŸ§‘ OneNoteì—ì„œ ë¬¸ì„œë¥¼ ê°€ì ¸ì˜¤ê¸° ìœ„í•œ ì§€ì¹¨

### ğŸ”‘ ì¸ì¦

ê¸°ë³¸ì ìœ¼ë¡œ `OneNoteLoader`ëŠ” `CLIENT_ID`ì™€ `CLIENT_SECRET` ê°’ì´ ê°ê° `MS_GRAPH_CLIENT_ID`ì™€ `MS_GRAPH_CLIENT_SECRET`ë¼ëŠ” ì´ë¦„ì˜ í™˜ê²½ ë³€ìˆ˜ë¡œ ì €ì¥ë˜ì–´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤. ì• í”Œë¦¬ì¼€ì´ì…˜ ë£¨íŠ¸ì— ìˆëŠ” `.env` íŒŒì¼ì„ í†µí•´ ë˜ëŠ” ìŠ¤í¬ë¦½íŠ¸ì—ì„œ ë‹¤ìŒ ëª…ë ¹ì„ ì‚¬ìš©í•˜ì—¬ ì´ëŸ¬í•œ í™˜ê²½ ë³€ìˆ˜ë¥¼ ì „ë‹¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```python
os.environ['MS_GRAPH_CLIENT_ID'] = "YOUR CLIENT ID"
os.environ['MS_GRAPH_CLIENT_SECRET'] = "YOUR CLIENT SECRET"
```

ì´ loaderëŠ” [*on behalf of a user*](https://learn.microsoft.com/en-us/graph/auth-v2-user?context=graph%2Fapi%2F1.0&view=graph-rest-1.0)ë¼ëŠ” ì¸ì¦ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. ì´ê²ƒì€ ì‚¬ìš©ì ë™ì˜ê°€ í•„ìš”í•œ 2ë‹¨ê³„ ì¸ì¦ì…ë‹ˆë‹¤. loaderë¥¼ ì¸ìŠ¤í„´ìŠ¤í™”í•˜ë©´ ì‚¬ìš©ìê°€ í•„ìš”í•œ ê¶Œí•œì— ëŒ€í•´ ì•±ì— ë™ì˜í•˜ê¸° ìœ„í•´ ë°©ë¬¸í•´ì•¼ í•˜ëŠ” urlì„ ì¶œë ¥í•©ë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ ì‚¬ìš©ìëŠ” ì´ urlì„ ë°©ë¬¸í•˜ì—¬ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ë™ì˜í•´ì•¼ í•©ë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ ì‚¬ìš©ìëŠ” ê²°ê³¼ í˜ì´ì§€ urlì„ ë³µì‚¬í•˜ì—¬ ì½˜ì†”ì— ë‹¤ì‹œ ë¶™ì—¬ë„£ì–´ì•¼ í•©ë‹ˆë‹¤. ê·¸ëŸ¬ë©´ ë¡œê·¸ì¸ ì‹œë„ê°€ ì„±ê³µí•œ ê²½ìš° ë©”ì„œë“œê°€ Trueë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.

```python
from langchain_community.document_loaders.onenote import OneNoteLoader

loader = OneNoteLoader(notebook_name="NOTEBOOK NAME", section_name="SECTION NAME", page_title="PAGE TITLE")
```

ì¸ì¦ì´ ì™„ë£Œë˜ë©´ loaderëŠ” `~/.credentials/` í´ë”ì— token(`onenote_graph_token.txt`)ì„ ì €ì¥í•©ë‹ˆë‹¤. ì´ tokenì€ ë‚˜ì¤‘ì— ì•ì„œ ì„¤ëª…í•œ ë³µì‚¬/ë¶™ì—¬ë„£ê¸° ë‹¨ê³„ ì—†ì´ ì¸ì¦í•˜ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì¸ì¦ì— ì´ tokenì„ ì‚¬ìš©í•˜ë ¤ë©´ loaderë¥¼ ì¸ìŠ¤í„´ìŠ¤í™”í•  ë•Œ `auth_with_token` ë§¤ê°œë³€ìˆ˜ë¥¼ Trueë¡œ ë³€ê²½í•´ì•¼ í•©ë‹ˆë‹¤.

```python
from langchain_community.document_loaders.onenote import OneNoteLoader

loader = OneNoteLoader(notebook_name="NOTEBOOK NAME", section_name="SECTION NAME", page_title="PAGE TITLE", auth_with_token=True)
```

ë˜ëŠ” tokenì„ loaderì— ì§ì ‘ ì „ë‹¬í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” ë‹¤ë¥¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ìƒì„±ëœ tokenìœ¼ë¡œ ì¸ì¦í•˜ë ¤ëŠ” ê²½ìš°ì— ìœ ìš©í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, [Microsoft Graph Explorer](https://developer.microsoft.com/en-us/graph/graph-explorer)ë¥¼ ì‚¬ìš©í•˜ì—¬ tokenì„ ìƒì„±í•œ ë‹¤ìŒ loaderì— ì „ë‹¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```python
from langchain_community.document_loaders.onenote import OneNoteLoader

loader = OneNoteLoader(notebook_name="NOTEBOOK NAME", section_name="SECTION NAME", page_title="PAGE TITLE", access_token="TOKEN")
```

### ğŸ—‚ï¸ Documents loader

#### ğŸ“‘ OneNote Notebookì—ì„œ í˜ì´ì§€ ë¡œë“œí•˜ê¸°

`OneNoteLoader`ëŠ” OneDriveì— ì €ì¥ëœ OneNote notebookì—ì„œ í˜ì´ì§€ë¥¼ ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. `notebook_name`, `section_name`, `page_title`ì˜ ì¡°í•©ì„ ì§€ì •í•˜ì—¬ íŠ¹ì • notebook ì•„ë˜, íŠ¹ì • section ì•„ë˜ ë˜ëŠ” íŠ¹ì • ì œëª©ì„ ê°€ì§„ í˜ì´ì§€ë¥¼ í•„í„°ë§í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, OneDriveì˜ ëª¨ë“  notebook ë‚´ì—ì„œ `Recipes`ë¼ëŠ” section ì•„ë˜ì— ì €ì¥ëœ ëª¨ë“  í˜ì´ì§€ë¥¼ ë¡œë“œí•˜ë ¤ëŠ” ê²½ìš°ì…ë‹ˆë‹¤.

```python
from langchain_community.document_loaders.onenote import OneNoteLoader

loader = OneNoteLoader(section_name="Recipes", auth_with_token=True)
documents = loader.load()
```

#### ğŸ“‘ Page ID ëª©ë¡ì—ì„œ í˜ì´ì§€ ë¡œë“œí•˜ê¸°

ë˜ ë‹¤ë¥¸ ë°©ë²•ì€ ë¡œë“œí•˜ë ¤ëŠ” ê° í˜ì´ì§€ì— ëŒ€í•œ `object_ids` ëª©ë¡ì„ ì œê³µí•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ì´ë¥¼ ìœ„í•´ì„œëŠ” [Microsoft Graph API](https://developer.microsoft.com/en-us/graph/graph-explorer)ë¥¼ ì¿¼ë¦¬í•˜ì—¬ ê´€ì‹¬ ìˆëŠ” ëª¨ë“  ë¬¸ì„œ IDë¥¼ ì°¾ì•„ì•¼ í•©ë‹ˆë‹¤. ì´ [ë§í¬](https://learn.microsoft.com/en-us/graph/onenote-get-content#page-collection)ëŠ” ë¬¸ì„œ IDë¥¼ ê²€ìƒ‰í•˜ëŠ” ë° ë„ì›€ì´ ë˜ëŠ” endpoint ëª©ë¡ì„ ì œê³µí•©ë‹ˆë‹¤.

ì˜ˆë¥¼ ë“¤ì–´, notebookì— ì €ì¥ëœ ëª¨ë“  í˜ì´ì§€ì— ëŒ€í•œ ì •ë³´ë¥¼ ê²€ìƒ‰í•˜ë ¤ë©´ `https://graph.microsoft.com/v1.0/me/onenote/pages`ì— ìš”ì²­ì„ í•´ì•¼ í•©ë‹ˆë‹¤. ê´€ì‹¬ ìˆëŠ” ID ëª©ë¡ì„ ì–»ìœ¼ë©´ ë‹¤ìŒ ë§¤ê°œë³€ìˆ˜ë¡œ loaderë¥¼ ì¸ìŠ¤í„´ìŠ¤í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```python
from langchain_community.document_loaders.onenote import OneNoteLoader

loader = OneNoteLoader(object_ids=["ID_1", "ID_2"], auth_with_token=True)
documents = loader.load()
```

```python

```