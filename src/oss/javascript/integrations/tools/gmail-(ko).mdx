---
title: Gmail Tool
---

Gmail Tool은 에이전트가 연결된 이메일 계정에서 메시지를 생성하고 조회할 수 있도록 합니다.

## Setup

두 가지 방법으로 인증할 수 있습니다:

1. OAuth2 token exchange를 통해 얻은 access token을 credentials 객체에 제공합니다.
   이는 문자열이거나 함수일 수 있으므로 token 만료 및 유효성 검사를 처리할 수 있습니다.
   이는 federated connection에서 access token을 가져오는 것을 지원하는 Identity Provider를 사용하여 수행할 수 있습니다.
   이는 access와 scope가 특정 최종 사용자로 제한되므로 가장 안전한 방법입니다.
   이 방법은 최종 사용자가 자신의 Gmail 계정으로 사용하도록 의도된 애플리케이션에서 tool을 사용할 때 더 적합합니다.
2. [Google 여기](https://developers.google.com/gmail/api/guides)에서 API key를 받고
   [새로운 Gmail API를 활성화](https://console.cloud.google.com/apis/library/gmail.googleapis.com)해야 합니다.
   그런 다음 `GMAIL_CLIENT_EMAIL`과 `GMAIL_PRIVATE_KEY` 또는 `GMAIL_KEYFILE` 중 하나에 대한 환경 변수를 설정합니다.

Gmail Tool을 사용하려면 다음 공식 peer dependency를 설치해야 합니다:

<Tip>
LangChain 패키지 설치에 대한 일반적인 지침은 [이 섹션](/oss/langchain/install)을 참조하세요.
</Tip>

```bash npm
npm install @langchain/openai @langchain/community @langchain/core googleapis
```

## Usage

```typescript
import { initializeAgentExecutorWithOptions } from "@langchain/classic/agents";
import { OpenAI } from "@langchain/openai";
import {
  GmailCreateDraft,
  GmailGetMessage,
  GmailGetThread,
  GmailSearch,
  GmailSendMessage,
} from "@langchain/community/tools/gmail";
import { StructuredTool } from "@langchain/core/tools";

export async function run() {
  const model = new OpenAI({
    temperature: 0,
    apiKey: process.env.OPENAI_API_KEY,
  });

  // These are the default parameters for the Gmail tools
  //   const gmailParams = {
  //     credentials: {
  //       clientEmail: process.env.GMAIL_CLIENT_EMAIL,
  //       privateKey: process.env.GMAIL_PRIVATE_KEY,
  //       // Either (privateKey + clientEmail) or accessToken is required
  //       accessToken: "an access token or function to get access token",
  //     },
  //     scopes: ["https://mail.google.com/"], // Not required if using access token
  //   };

  // For custom parameters, uncomment the code above, replace the values with your own, and pass it to the tools below
  const tools: StructuredTool[] = [
    new GmailCreateDraft(),
    new GmailGetMessage(),
    new GmailGetThread(),
    new GmailSearch(),
    new GmailSendMessage(),
  ];

  const gmailAgent = await initializeAgentExecutorWithOptions(tools, model, {
    agentType: "structured-chat-zero-shot-react-description",
    verbose: true,
  });

  const createInput = `Create a gmail draft for me to edit of a letter from the perspective of a sentient parrot who is looking to collaborate on some research with her estranged friend, a cat. Under no circumstances may you send the message, however.`;

  const createResult = await gmailAgent.invoke({ input: createInput });
  //   Create Result {
  //     output: 'I have created a draft email for you to edit. The draft Id is r5681294731961864018.'
  //   }
  console.log("Create Result", createResult);

  const viewInput = `Could you search in my drafts for the latest email?`;

  const viewResult = await gmailAgent.invoke({ input: viewInput });
  //   View Result {
  //     output: "The latest email in your drafts is from hopefulparrot@gmail.com with the subject 'Collaboration Opportunity'. The body of the email reads: 'Dear [Friend], I hope this letter finds you well. I am writing to you in the hopes of rekindling our friendship and to discuss the possibility of collaborating on some research together. I know that we have had our differences in the past, but I believe that we can put them aside and work together for the greater good. I look forward to hearing from you. Sincerely, [Parrot]'"
  //   }
  console.log("View Result", viewResult);
}
```

## Related

- Tool [개념 가이드](/oss/langchain/tools)
- Tool [사용 방법 가이드](/oss/langchain/tools)