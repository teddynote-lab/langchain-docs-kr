```mdx
---
title: Azure Cosmos DB for MongoDB vCore
---

> [Azure Cosmos DB for MongoDB vCore](https://learn.microsoft.com/azure/cosmos-db/mongodb/vcore/)를 사용하면 완전한 네이티브 MongoDB 지원을 제공하는 데이터베이스를 쉽게 만들 수 있습니다. MongoDB 경험을 활용하고 애플리케이션을 API for MongoDB vCore 계정의 연결 문자열로 지정하여 즐겨 사용하는 MongoDB 드라이버, SDK 및 도구를 계속 사용할 수 있습니다. Azure Cosmos DB for MongoDB vCore의 vector search를 사용하여 AI 기반 애플리케이션을 Azure Cosmos DB에 저장된 데이터와 원활하게 통합할 수 있습니다.

Azure Cosmos DB for MongoDB vCore는 개발자에게 친숙한 아키텍처로 최신 애플리케이션을 구축할 수 있는 완전 관리형 MongoDB 호환 데이터베이스 서비스를 제공합니다.

Azure Cosmos DB for MongoDB vCore의 vector search 기능을 활용하는 방법은 [이 페이지](https://learn.microsoft.com/azure/cosmos-db/mongodb/vcore/vector-search)에서 알아보세요. Azure 계정이 없는 경우 [무료 계정을 만들어](https://azure.microsoft.com/free/) 시작할 수 있습니다.

## Setup

먼저 [`@langchain/azure-cosmosdb`](https://www.npmjs.com/package/@langchain/azure-cosmosdb) 패키지를 설치해야 합니다:

<Tip>
LangChain 패키지 설치에 대한 일반적인 지침은 [이 섹션](/oss/langchain/install)을 참조하세요.
</Tip>

```bash npm
npm install @langchain/azure-cosmosdb @langchain/core
```

또한 Azure Cosmos DB for MongoDB vCore 인스턴스가 실행 중이어야 합니다. [이 가이드](https://learn.microsoft.com/azure/cosmos-db/mongodb/vcore/quickstart-portal)를 따라 Azure Portal에서 무료 버전을 비용 없이 배포할 수 있습니다.

인스턴스가 실행되면 연결 문자열과 admin key가 있는지 확인하세요. Azure Portal의 인스턴스 "Connection strings" 섹션에서 찾을 수 있습니다. 그런 다음 다음 환경 변수를 설정해야 합니다:

```bash .env vars
AZURE_COSMOSDB_MONGODB_CONNECTION_STRING=
```

## Example

다음은 Azure Cosmos DB for MongoDB vCore에서 파일의 문서를 인덱싱하고, vector search 쿼리를 실행한 다음, chain을 사용하여 검색된 문서를 기반으로 자연어로 질문에 답변하는 예제입니다.

```typescript
import {
  AzureCosmosDBMongoDBVectorStore,
  AzureCosmosDBMongoDBSimilarityType,
} from "@langchain/azure-cosmosdb";
import { ChatPromptTemplate } from "@langchain/core/prompts";
import { ChatOpenAI, OpenAIEmbeddings } from "@langchain/openai";
import { createStuffDocumentsChain } from "@langchain/classic/chains/combine_documents";
import { createRetrievalChain } from "@langchain/classic/chains/retrieval";
import { TextLoader } from "@langchain/classic/document_loaders/fs/text";
import { RecursiveCharacterTextSplitter } from "@langchain/textsplitters";

// Load documents from file
const loader = new TextLoader("./state_of_the_union.txt");
const rawDocuments = await loader.load();
const splitter = new RecursiveCharacterTextSplitter({
  chunkSize: 1000,
  chunkOverlap: 0,
});
const documents = await splitter.splitDocuments(rawDocuments);

// Create Azure Cosmos DB for MongoDB vCore vector store
const store = await AzureCosmosDBMongoDBVectorStore.fromDocuments(
  documents,
  new OpenAIEmbeddings(),
  {
    databaseName: "langchain",
    collectionName: "documents",
    indexOptions: {
      numLists: 100,
      dimensions: 1536,
      similarity: AzureCosmosDBMongoDBSimilarityType.COS,
    },
  }
);

// Performs a similarity search
const resultDocuments = await store.similaritySearch(
  "What did the president say about Ketanji Brown Jackson?"
);

console.log("Similarity search results:");
console.log(resultDocuments[0].pageContent);
/*
  Tonight. I call on the Senate to: Pass the Freedom to Vote Act. Pass the John Lewis Voting Rights Act. And while you’re at it, pass the Disclose Act so Americans can know who is funding our elections.

  Tonight, I’d like to honor someone who has dedicated his life to serve this country: Justice Stephen Breyer—an Army veteran, Constitutional scholar, and retiring Justice of the United States Supreme Court. Justice Breyer, thank you for your service.

  One of the most serious constitutional responsibilities a President has is nominating someone to serve on the United States Supreme Court.

  And I did that 4 days ago, when I nominated Circuit Court of Appeals Judge Ketanji Brown Jackson. One of our nation’s top legal minds, who will continue Justice Breyer’s legacy of excellence.
*/

// Use the store as part of a chain
const model = new ChatOpenAI({ model: "gpt-3.5-turbo-1106" });
const questionAnsweringPrompt = ChatPromptTemplate.fromMessages([
  [
    "system",
    "Answer the user's questions based on the below context:\n\n{context}",
  ],
  ["human", "{input}"],
]);

const combineDocsChain = await createStuffDocumentsChain({
  llm: model,
  prompt: questionAnsweringPrompt,
});

const chain = await createRetrievalChain({
  retriever: store.asRetriever(),
  combineDocsChain,
});

const res = await chain.invoke({
  input: "What is the president's top priority regarding prices?",
});

console.log("Chain response:");
console.log(res.answer);
/*
  The president's top priority is getting prices under control.
*/

// Clean up
await store.delete();

await store.close();
```

## Related

- Vector store [개념 가이드](/oss/integrations/vectorstores)
- Vector store [사용 방법 가이드](/oss/integrations/vectorstores)
```