---
title: Neon Postgres
---

Neon은 완전 관리형 서버리스 PostgreSQL 데이터베이스입니다. 스토리지와 컴퓨팅을 분리하여 즉각적인 브랜칭 및 자동 스케일링과 같은 기능을 제공합니다.

`pgvector` 확장을 통해 Neon은 LangChain.js와 함께 사용하여 임베딩을 저장하고 쿼리할 수 있는 vector store를 제공합니다.

## Setup

### Neon 프로젝트 선택

Neon 계정이 없다면 [Neon](https://neon.tech)에서 가입하세요. Neon Console에 로그인한 후 [Projects](https://console.neon.tech/app/projects) 섹션으로 이동하여 기존 프로젝트를 선택하거나 새 프로젝트를 생성하세요.

Neon 프로젝트에는 임베딩을 저장하는 데 사용할 수 있는 `neondb`라는 즉시 사용 가능한 Postgres 데이터베이스가 함께 제공됩니다. Connection Details 섹션으로 이동하여 데이터베이스 연결 문자열을 찾으세요. 다음과 유사하게 보일 것입니다:

```text
postgres://alex:AbC123dEf@ep-cool-darkness-123456.us-east-2.aws.neon.tech/dbname?sslmode=require
```

나중에 사용할 수 있도록 연결 문자열을 보관해 두세요.

### Application 코드

Neon Postgres를 사용하려면 데이터베이스에 연결하기 위한 JavaScript/TypeScript 드라이버를 제공하는 `@neondatabase/serverless` 패키지를 설치해야 합니다.

```bash npm
npm install @neondatabase/serverless
```
<Tip>
LangChain 패키지 설치에 대한 일반적인 지침은 [이 섹션](/oss/langchain/install)을 참조하세요.
</Tip>

```bash npm
npm install @langchain/community @langchain/core
```
`NeonPostgres` vectorstore를 초기화하려면 Neon 데이터베이스 연결 문자열을 제공해야 합니다. 위에서 가져온 연결 문자열을 직접 사용하거나 환경 변수로 저장하여 코드에서 사용할 수 있습니다.

```typescript
const vectorStore = await NeonPostgres.initialize(embeddings, {
  connectionString: NEON_POSTGRES_CONNECTION_STRING,
});
```

## Usage

```typescript
import { OpenAIEmbeddings } from "@langchain/openai";
import { NeonPostgres } from "@langchain/community/vectorstores/neon";

// Initialize an embeddings instance
const embeddings = new OpenAIEmbeddings({
  apiKey: process.env.OPENAI_API_KEY,
  dimensions: 256,
  model: "text-embedding-3-small",
});

// Initialize a NeonPostgres instance to store embedding vectors
const vectorStore = await NeonPostgres.initialize(embeddings, {
  connectionString: process.env.DATABASE_URL as string,
});

// You can add documents to the store, strings in the `pageContent` field will be embedded
// and stored in the database
const documents = [
  { pageContent: "Hello world", metadata: { topic: "greeting" } },
  { pageContent: "Bye bye", metadata: { topic: "greeting" } },
  {
    pageContent: "Mitochondria is the powerhouse of the cell",
    metadata: { topic: "science" },
  },
];
const idsInserted = await vectorStore.addDocuments(documents);

// You can now query the store for similar documents to the input query
const resultOne = await vectorStore.similaritySearch("hola", 1);
console.log(resultOne);
/*
[
  Document {
    pageContent: 'Hello world',
    metadata: { topic: 'greeting' }
  }
]
*/

// You can also filter by metadata
const resultTwo = await vectorStore.similaritySearch("Irrelevant query", 2, {
  topic: "science",
});
console.log(resultTwo);
/*
[
  Document {
    pageContent: 'Mitochondria is the powerhouse of the cell',
    metadata: { topic: 'science' }
  }
]
*/

// Metadata filtering with IN-filters works as well
const resultsThree = await vectorStore.similaritySearch("Irrelevant query", 2, {
  topic: { in: ["greeting"] },
});
console.log(resultsThree);
/*
[
  Document { pageContent: 'Bye bye', metadata: { topic: 'greeting' } },
  Document {
    pageContent: 'Hello world',
    metadata: { topic: 'greeting' }
  }
]
*/

// Upserting is supported as well
await vectorStore.addDocuments(
  [
    {
      pageContent: "ATP is the powerhouse of the cell",
      metadata: { topic: "science" },
    },
  ],
  { ids: [idsInserted[2]] }
);

const resultsFour = await vectorStore.similaritySearch(
  "powerhouse of the cell",
  1
);
console.log(resultsFour);
/*
[
  Document {
    pageContent: 'ATP is the powerhouse of the cell',
    metadata: { topic: 'science' }
  }
]
*/
```

## Related

- Vector store [개념 가이드](/oss/integrations/vectorstores)
- Vector store [사용 방법 가이드](/oss/integrations/vectorstores)