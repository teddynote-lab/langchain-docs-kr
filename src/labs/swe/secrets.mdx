---
title: "Secrets"
description: "개발 환경에서의 환경 변수 및 시크릿 접근"
---

Open-SWE는 사용자 환경 변수를 에이전트와 안전하게 공유하고 개발 서버에 전달하기 위한 안전하고 암호화된 방법을 구현합니다.

## 환경 변수 및 API Key

### API Key 보호 방법

API key는 전송 중과 저장 시 모두 업계 표준인 AES-256-GCM 암호화로 보호됩니다.

**저장 프로세스:**
1. **Frontend**: 브라우저 localStorage에 임시 저장 (평문)
2. **전송**: backend로 전송하기 전에 AES-256-GCM으로 암호화
3. **Backend**: LangGraph의 데이터베이스에 암호화되어 저장
4. **Runtime**: 서버 측 암호화 키를 사용하여 필요할 때 복호화

<Accordion title="기술적 암호화 세부사항">
  **암호화 세부사항:**
  - **Algorithm**: [AES-256-GCM](https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-38d.pdf) (인증된 암호화)
  - **Key Derivation**: 시스템 `SECRETS_ENCRYPTION_KEY`의 SHA-256 해시
  - **IV Generation**: 암호화당 무작위 12바이트 초기화 벡터
  - **Authentication**: 16바이트 인증 태그로 변조 방지
</Accordion>

### 시스템 환경 변수 vs 사용자 환경 변수

Open-SWE는 두 가지 유형의 환경 변수를 처리합니다:

**시스템 환경 변수:**
- **목적**: Open-SWE를 실행하는 데 필요한 환경 변수. 자체 호스팅하는 경우 LLM, 인프라 및 인증 키를 설정할 수 있습니다
- **예시**: `DAYTONA_API_KEY`, `SECRETS_ENCRYPTION_KEY`, `GITHUB_APP_PRIVATE_KEY`
- **접근**: `process.env`를 통한 서버 측 전용
- **보안**: 사용자나 sandbox에 노출되지 않음

**사용자 정의 환경 변수:**
- **목적**: 개인 API key 및 사용자 정의 개발 변수
- **예시**: `ANTHROPIC_API_KEY`, `MY_DATABASE_URL`, `STRIPE_TEST_KEY`
- **접근**: UI의 설정 페이지를 통해 사용자가 제어
- **보안**: AES-256-GCM 암호화 + 개발 서버에 전달하려면 명시적인 사용자 동의 필요

### API Key가 Sandbox 환경에 노출되는 경우

API key는 sandbox 환경에 **자동으로 노출되지 않습니다**. 노출하려면 명시적인 사용자 동의가 필요합니다.

왜 sandbox 환경에 API key가 필요한지 궁금할 수 있습니다. 우리는 Open-SWE를 주니어 개발자로 설계했습니다. 개발의 일부는 실시간으로 코드를 테스트하는 것입니다. **Open-SWE는 실행 중인 sandbox 내에서 LangGraph 에이전트, Next.js 앱, Flask 서버 등을 실행할 수 있는 개발 서버를 시작할 수 있는 기능을 가지고 있습니다.** 이 옵션이 유용할 수 있다고 생각한다면, sandbox에 키를 전달하는 것이 무엇을 의미하는지 검토해 주세요.

<Note>
  sandbox 접근을 활성화할 때는 프로덕션 키 대신 제한된 권한을 가진 별도의 개발 API key를 사용하는 것을 고려하세요. 이렇게 하면 기능을 유지하면서 잠재적 노출의 영향을 줄일 수 있습니다.
</Note>

**기본 동작 (안전):**
- API key는 LLM 모델 초기화 및 사용자가 전달한 경우 자체 키를 사용한 Daytona 설정에만 사용됩니다
- 키는 sandbox의 환경 변수로 사용할 수 없으며 LLM이 접근할 수 없습니다
- 각 키는 기본적으로 `allowedInDev: false`로 설정됩니다

**"Include in Dev Server"를 활성화하는 경우:**
- 각 API key에 대해 수동으로 스위치를 전환합니다
- 키가 sandbox의 환경 변수로 사용 가능해집니다
- 어떤 키가 노출되는지 제어할 수 있습니다

## Sandbox 보안 및 격리

### Container 격리

각 사용자 세션은 여러 보안 경계를 가진 완전히 격리된 Daytona container에서 실행됩니다. 이러한 container는 새 브랜치에서 저장소의 코드를 수정할 수 있으며 세션 간에 정보를 교환하지 않습니다.

<Accordion title="격리 세부사항">
  **Container 격리:**
  - 사용자 세션당 별도의 container
  - container 간 공유 파일 시스템 없음
  - Container 수준의 리소스 제한 및 할당량

  **프로세스 격리:**
  - 사용자 환경 변수 vs 시스템 환경 변수
  - Sandbox 프로세스는 호스트 시스템이나 코드에 접근할 수 없음

  **시간적 격리:**
  - 15분 동안 활동이 없으면 자동 삭제
  - 세션 간 영구 저장소 없음
  - 각 새 세션마다 새로운 환경

  **네트워크 격리:**
  - Container 간 통신 불가
</Accordion>

## 데이터 처리 및 접근 제어

<Warning>
  API key에 대해 "Include in Dev Server"를 활성화하면 자격 증명의 공격 표면이 확대됩니다. AI 에이전트가 생성된 코드나 로그에서 실수로 환경 변수를 노출할 수 있습니다. 개발 서버 모니터링에 필요한 경우에만 이 기능을 사용하세요.
</Warning>

### 개발 환경 노출 위험

개발 서버를 모니터링하는 것이 유용하다고 생각되는 경우에만 이 기능을 사용해야 합니다. 메인 키를 사용하지 말고 sandbox 환경에 전달하는 키에 대한 접근 제어를 설정하는 것을 권장합니다.

Open-SWE UI와 에이전트는 암호화를 사용하여 이를 교환하지만, **LLM이 코드에서 환경 변수를 노출된 상태로 남길 수 있습니다.**

## 보안 모범 사례

우리 팀은 내부적으로 Open-SWE를 사용하는 것을 좋아하며 다음과 같은 모범 사례를 권장합니다:

- 각 API key에 필요한 최소 권한 사용
- API key를 정기적으로 교체
- 특정 도구에 필요한 경우에만 "Include in Dev Server" 활성화
- 설정에서 "Last Used" 타임스탬프 모니터링
- sandbox 환경에는 프로덕션 키 대신 별도의 개발 키 사용 고려
- 프로덕션 데이터베이스 자격 증명이나 높은 권한의 API key에 대해서는 sandbox 접근을 절대 활성화하지 마세요
- 배포하기 전에 생성된 코드에서 실수로 노출된 환경 변수가 있는지 검토