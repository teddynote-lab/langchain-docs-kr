---
title: Elasticsearch
---

<Tip>
**호환성**: Node.js에서만 사용 가능합니다.
</Tip>

[Elasticsearch](https://github.com/elastic/elasticsearch)는 프로덕션 규모의 워크로드에서 속도와 관련성을 최적화한 분산형 RESTful 검색 엔진입니다. [k-nearest neighbor](https://en.wikipedia.org/wiki/K-nearest_neighbors_algorithm) (kNN) 알고리즘을 사용한 벡터 검색과 [자연어 처리를 위한 커스텀 모델](https://www.elastic.co/blog/how-to-deploy-nlp-text-embeddings-and-vector-search) (NLP)도 지원합니다.
Elasticsearch의 벡터 검색 지원에 대한 자세한 내용은 [여기](https://www.elastic.co/guide/en/elasticsearch/reference/current/knn-search.html)에서 확인할 수 있습니다.

이 가이드는 Elasticsearch [vector store](/oss/javascript/integrations/vectorstores) 시작하기에 대한 간단한 개요를 제공합니다. 모든 `ElasticVectorSearch` 기능 및 구성에 대한 자세한 문서는 [API reference](https://api.js.langchain.com/classes/langchain_community_vectorstores_elasticsearch.ElasticVectorSearch.html)를 참조하세요.

## 개요

### Integration 세부 정보

| Class | Package | [PY support](https://python.langchain.com/docs/integrations/vectorstores/elasticsearch/) |  Version |
| :--- | :--- | :---: | :---: |
| [`ElasticVectorSearch`](https://api.js.langchain.com/classes/langchain_community_vectorstores_elasticsearch.ElasticVectorSearch.html) | [`@langchain/community`](https://www.npmjs.com/package/@langchain/community) | ✅ |  ![NPM - Version](https://img.shields.io/npm/v/@langchain/community?style=flat-square&label=%20&) |

## 설정

Elasticsearch vector store를 사용하려면 `@langchain/community` integration package를 설치해야 합니다.

LangChain.js는 Elasticsearch vectorstore의 client로 [`@elastic/elasticsearch`](https://github.com/elastic/elasticsearch-js)를 사용합니다. peer dependency로 설치해야 합니다.

이 가이드는 [OpenAI embeddings](/oss/javascript/integrations/text_embedding/openai)도 사용하므로 `@langchain/openai` integration package를 설치해야 합니다. 원하는 경우 [다른 지원되는 embeddings 모델](/oss/javascript/integrations/text_embedding)을 사용할 수도 있습니다.

<CodeGroup>
```bash npm
npm install @langchain/community @elastic/elasticsearch @langchain/openai @langchain/core
```
```bash yarn
yarn add @langchain/community @elastic/elasticsearch @langchain/openai @langchain/core
```
```bash pnpm
pnpm add @langchain/community @elastic/elasticsearch @langchain/openai @langchain/core
```
</CodeGroup>

### 자격 증명

Elasticsearch vector store를 사용하려면 실행 중인 Elasticsearch 인스턴스가 필요합니다.

[공식 Docker 이미지](https://www.elastic.co/guide/en/elasticsearch/reference/current/docker.html)를 사용하여 시작하거나 Elastic의 공식 클라우드 서비스인 [Elastic Cloud](https://www.elastic.co/cloud/)를 사용할 수 있습니다.

Elastic Cloud에 연결하려면 API key를 얻기 위해 [여기](https://www.elastic.co/guide/en/kibana/current/api-keys.html)에 설명된 문서를 참조하세요.

이 가이드에서 OpenAI embeddings를 사용하는 경우 OpenAI key도 설정해야 합니다:

```typescript
process.env.OPENAI_API_KEY = "YOUR_API_KEY";
```

모델 호출에 대한 자동 추적을 원하는 경우 아래 주석을 해제하여 [LangSmith](https://docs.smith.langchain.com/) API key를 설정할 수도 있습니다:

```typescript
// process.env.LANGSMITH_TRACING="true"
// process.env.LANGSMITH_API_KEY="your-api-key"
```

## 인스턴스화

Elasticsearch 인스턴스화는 인스턴스가 호스팅되는 위치에 따라 달라집니다.

```typescript
import {
  ElasticVectorSearch,
  type ElasticClientArgs,
} from "@langchain/community/vectorstores/elasticsearch";
import { OpenAIEmbeddings } from "@langchain/openai";

import { Client, type ClientOptions } from "@elastic/elasticsearch";

import * as fs from "node:fs";

const embeddings = new OpenAIEmbeddings({
  model: "text-embedding-3-small",
});

const config: ClientOptions = {
  node: process.env.ELASTIC_URL ?? "https://127.0.0.1:9200",
};

if (process.env.ELASTIC_API_KEY) {
  config.auth = {
    apiKey: process.env.ELASTIC_API_KEY,
  };
} else if (process.env.ELASTIC_USERNAME && process.env.ELASTIC_PASSWORD) {
  config.auth = {
    username: process.env.ELASTIC_USERNAME,
    password: process.env.ELASTIC_PASSWORD,
  };
}
// Local Docker deploys require a TLS certificate
if (process.env.ELASTIC_CERT_PATH) {
  config.tls = {
    ca: fs.readFileSync(process.env.ELASTIC_CERT_PATH),
    rejectUnauthorized: false,
  }
}
const clientArgs: ElasticClientArgs = {
  client: new Client(config),
  indexName: process.env.ELASTIC_INDEX ?? "test_vectorstore",
};

const vectorStore = new ElasticVectorSearch(embeddings, clientArgs);
```

## Vector store 관리

### Vector store에 항목 추가

```typescript
import type { Document } from "@langchain/core/documents";

const document1: Document = {
  pageContent: "The powerhouse of the cell is the mitochondria",
  metadata: { source: "https://example.com" }
};

const document2: Document = {
  pageContent: "Buildings are made out of brick",
  metadata: { source: "https://example.com" }
};

const document3: Document = {
  pageContent: "Mitochondria are made out of lipids",
  metadata: { source: "https://example.com" }
};

const document4: Document = {
  pageContent: "The 2024 Olympics are in Paris",
  metadata: { source: "https://example.com" }
}

const documents = [document1, document2, document3, document4];

await vectorStore.addDocuments(documents, { ids: ["1", "2", "3", "4"] });
```

```output
[ '1', '2', '3', '4' ]
```

### Vector store에서 항목 삭제

전달한 것과 동일한 id를 전달하여 store에서 값을 삭제할 수 있습니다:

```typescript
await vectorStore.delete({ ids: ["4"] });
```

## Vector store 쿼리

Vector store가 생성되고 관련 문서가 추가되면 chain 또는 agent를 실행하는 동안 쿼리하고 싶을 것입니다.

### 직접 쿼리

간단한 유사도 검색은 다음과 같이 수행할 수 있습니다:

```typescript
const filter = [{
  operator: "match",
  field: "source",
  value: "https://example.com",
}];

const similaritySearchResults = await vectorStore.similaritySearch("biology", 2, filter);

for (const doc of similaritySearchResults) {
  console.log(`* ${doc.pageContent} [${JSON.stringify(doc.metadata, null)}]`);
}
```

```output
* The powerhouse of the cell is the mitochondria [{"source":"https://example.com"}]
* Mitochondria are made out of lipids [{"source":"https://example.com"}]
```

Vector store는 [Elasticsearch filter syntax](https://www.elastic.co/guide/en/elasticsearch/reference/current/query-filter-context.html) 연산자를 지원합니다.

유사도 검색을 실행하고 해당 점수를 받으려면 다음을 실행할 수 있습니다:

```typescript
const similaritySearchWithScoreResults = await vectorStore.similaritySearchWithScore("biology", 2, filter)

for (const [doc, score] of similaritySearchWithScoreResults) {
  console.log(`* [SIM=${score.toFixed(3)}] ${doc.pageContent} [${JSON.stringify(doc.metadata)}]`);
}
```

```output
* [SIM=0.374] The powerhouse of the cell is the mitochondria [{"source":"https://example.com"}]
* [SIM=0.370] Mitochondria are made out of lipids [{"source":"https://example.com"}]
```

### Retriever로 변환하여 쿼리

Vector store를 [retriever](/oss/javascript/langchain/retrieval)로 변환하여 chain에서 더 쉽게 사용할 수도 있습니다.

```typescript
const retriever = vectorStore.asRetriever({
  // Optional filter
  filter: filter,
  k: 2,
});
await retriever.invoke("biology");
```

```output
[
  Document {
    pageContent: 'The powerhouse of the cell is the mitochondria',
    metadata: { source: 'https://example.com' },
    id: undefined
  },
  Document {
    pageContent: 'Mitochondria are made out of lipids',
    metadata: { source: 'https://example.com' },
    id: undefined
  }
]
```

### Retrieval-augmented generation 사용

Retrieval-augmented generation (RAG)을 위해 이 vector store를 사용하는 방법에 대한 가이드는 다음 섹션을 참조하세요:

- [LangChain으로 RAG 앱 만들기](/oss/javascript/langchain/rag)
- [Agentic RAG](/oss/javascript/langgraph/agentic-rag)
- [Retrieval 문서](/oss/javascript/langchain/retrieval)

## API reference

모든 `ElasticVectorSearch` 기능 및 구성에 대한 자세한 문서는 [API reference](https://api.js.langchain.com/classes/langchain_community_vectorstores_elasticsearch.ElasticVectorSearch.html)를 참조하세요.

---

<Callout icon="pen-to-square" iconType="regular">
    [Edit the source of this page on GitHub.](https://github.com/langchain-ai/docs/edit/main/src/oss/javascript/integrations/vectorstores/elasticsearch.mdx)
</Callout>
<Tip icon="terminal" iconType="regular">
    [Connect these docs programmatically](/use-these-docs) to Claude, VSCode, and more via MCP for    real-time answers.
</Tip>
