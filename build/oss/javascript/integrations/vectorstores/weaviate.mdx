---
title: WeaviateStore
---

[Weaviate](https://weaviate.io/)는 객체와 벡터를 모두 저장하는 오픈 소스 벡터 데이터베이스로, 벡터 검색과 구조화된 필터링을 결합할 수 있습니다. LangChain은 Weaviate의 공식 Typescript 클라이언트인 weaviate-client 패키지를 통해 Weaviate에 연결됩니다.

이 가이드는 Weaviate [vector stores](/oss/javascript/integrations/vectorstores) 시작하기에 대한 간단한 개요를 제공합니다. 모든 `WeaviateStore` 기능 및 구성에 대한 자세한 문서는 [API reference](https://api.js.langchain.com/classes/langchain_weaviate.WeaviateStore.html)를 참조하세요.

## Overview

### Integration details

| Class | Package | [PY support](https://python.langchain.com/docs/integrations/vectorstores/weaviate/) |  Version |
| :--- | :--- | :---: | :---: |
| [`WeaviateStore`](https://api.js.langchain.com/classes/langchain_weaviate.WeaviateStore.html) | [`@langchain/weaviate`](https://npmjs.com/@langchain/weaviate) | ✅ |  ![NPM - Version](https://img.shields.io/npm/v/@langchain/weaviate?style=flat-square&label=%20&) |

## Setup

Weaviate vector store를 사용하려면 Weaviate 인스턴스를 설정하고 `@langchain/weaviate` integration 패키지를 설치해야 합니다. 또한 인스턴스에 연결할 클라이언트를 초기화하기 위해 `weaviate-client` 패키지를 설치해야 하며, 인덱싱된 문서에 id를 할당하려면 `uuid` 패키지도 설치해야 합니다.

이 가이드는 [OpenAI embeddings](/oss/javascript/integrations/text_embedding/openai)도 사용하므로 `@langchain/openai` integration 패키지를 설치해야 합니다. 원하는 경우 [다른 지원되는 embeddings 모델](/oss/javascript/integrations/text_embedding)을 사용할 수도 있습니다.

<CodeGroup>
```bash npm
npm install @langchain/weaviate @langchain/core weaviate-client uuid @langchain/openai
```
```bash yarn
yarn add @langchain/weaviate @langchain/core weaviate-client uuid @langchain/openai
```
```bash pnpm
pnpm add @langchain/weaviate @langchain/core weaviate-client uuid @langchain/openai
```
</CodeGroup>

Weaviate를 로컬 또는 서버에서 실행해야 합니다. 자세한 내용은 [Weaviate 문서](https://weaviate.io/developers/weaviate/installation)를 참조하세요.

### Credentials

인스턴스를 설정한 후 다음 환경 변수를 설정하세요:

```typescript
// If running locally, include port e.g. "localhost:8080"
process.env.WEAVIATE_URL = "YOUR_WEAVIATE_URL";
// Optional, for cloud deployments
process.env.WEAVIATE_API_KEY = "YOUR_API_KEY";
```

이 가이드에서 OpenAI embeddings를 사용하는 경우 OpenAI 키도 설정해야 합니다:

```typescript
process.env.OPENAI_API_KEY = "YOUR_API_KEY";
```

모델 호출에 대한 자동 추적을 원하는 경우 아래 주석을 해제하여 [LangSmith](https://docs.smith.langchain.com/) API 키를 설정할 수도 있습니다:

```typescript
// process.env.LANGSMITH_TRACING="true"
// process.env.LANGSMITH_API_KEY="your-api-key"
```

## Instantiation

### weaviate client 연결

대부분의 경우 Weaviate 인스턴스에 연결하기 위해 연결 헬퍼 함수 중 하나를 사용해야 합니다:

- connectToWeaviateCloud
- connectToLocal
- connectToCustom

```typescript
import { WeaviateStore } from "@langchain/weaviate";
import { OpenAIEmbeddings } from "@langchain/openai";
import weaviate from "weaviate-client";

const embeddings = new OpenAIEmbeddings({
  model: "text-embedding-3-small",
});

const weaviateClient = weaviate.connectToWeaviateCloud({
   clusterURL: process.env.WEAVIATE_URL!,
  options : {
      authCredentials: new weaviate.ApiKey(process.env.WEAVIATE_API_KEY || ""),
      headers: {
        "X-OpenAI-Api-Key": process.env.OPENAI_API_KEY || "",
        "X-Cohere-Api-Key": process.env.COHERE_API_KEY || "",
      },
    },
});
```

### vectorStore 초기화

collection을 생성하려면 최소한 collection 이름을 지정해야 합니다. property를 지정하지 않으면 `auto-schema`가 자동으로 생성합니다.

```typescript
const vectorStore = new WeaviateStore(embeddings, {
  client: weaviateClient,
  // Must start with a capital letter
  indexName: "Langchainjs_test",
});
```

Weaviate의 named vectors, vectorizers, reranker, generative-models 등을 사용하려면 vector store를 활성화할 때 `schema` property를 사용하세요. `schema`의 collection 이름 및 기타 property는 vector store를 생성할 때 우선적으로 적용됩니다.

```typescript
const vectorStore = new WeaviateStore(embeddings, {
  client: weaviateClient,
  schema: {
    name: "Langchainjs_test",
    description: "A simple dataset",
    properties: [
      {
        name: "title",
        dataType: dataType.TEXT,
      },
      {
        name: "foo",
        dataType: dataType.TEXT,
      },
    ],
    vectorizers: [
      vectorizer.text2VecOpenAI({
        name: "title",
        sourceProperties: ["title"], // (Optional) Set the source property(ies)
        // vectorIndexConfig: configure.vectorIndex.hnsw()   // (Optional) Set the vector index configuration
      }),
    ],
    generative: weaviate.configure.generative.openAI(),
    reranker: weaviate.configure.reranker.cohere(),
  },
});
```

## Manage vector store

### vector store에 항목 추가

**참고:** 인덱싱된 문서에 id를 연결하려면 UUID여야 합니다.

```typescript
import type { Document } from "@langchain/core/documents";
import { v4 as uuidv4 } from "uuid";

const document1: Document = {
  pageContent: "The powerhouse of the cell is the mitochondria",
  metadata: { source: "https://example.com" }
};

const document2: Document = {
  pageContent: "Buildings are made out of brick",
  metadata: { source: "https://example.com" }
};

const document3: Document = {
  pageContent: "Mitochondria are made out of lipids",
  metadata: { source: "https://example.com" }
};

const document4: Document = {
  pageContent: "The 2024 Olympics are in Paris",
  metadata: { source: "https://example.com" }
}

const documents = [document1, document2, document3, document4];
const uuids = [uuidv4(), uuidv4(), uuidv4(), uuidv4()];

await vectorStore.addDocuments(documents, { ids: uuids });
```

```output
[
  '610f9b92-9bee-473f-a4db-8f2ca6e3442d',
  '995160fa-441e-41a0-b476-cf3785518a0d',
  '0cdbe6d4-0df8-4f99-9b67-184009fee9a2',
  '18a8211c-0649-467b-a7c5-50ebb4b9ca9d'
]
```

### vector store에서 항목 삭제

id로 삭제하거나 `filter` 파라미터를 전달하여 삭제할 수 있습니다:

```typescript
await vectorStore.delete({ ids: [uuids[3]] });
```

## Query vector store

vector store가 생성되고 관련 문서가 추가되면 chain 또는 agent를 실행하는 동안 쿼리하고 싶을 것입니다.
Weaviate의 v3에서 클라이언트는 데이터베이스의 객체를 다루는 주요 방법으로 `collections`와 상호작용합니다. `collection` 객체는 코드베이스 전체에서 재사용할 수 있습니다.

### 직접 쿼리

간단한 유사도 검색은 다음과 같이 수행할 수 있습니다. `Filter` 헬퍼 클래스를 사용하면 조건이 있는 필터를 더 쉽게 사용할 수 있습니다. v3 클라이언트는 `Filter` 사용 방식을 간소화하여 코드를 더 깔끔하고 간결하게 만듭니다.

Weaviate 필터 구문에 대한 자세한 내용은 [이 페이지](https://weaviate.io/developers/weaviate/api/graphql/filters)를 참조하세요.

```typescript
import { Filters } from "weaviate-client";

const collection = client.collections.use('Langchainjs_test');

const filter = Filters.and(collection.filter.byProperty("source").equal("https://example.com"))

const similaritySearchResults = await vectorStore.similaritySearch("biology", 2, filter);

for (const doc of similaritySearchResults) {
  console.log(`* ${doc.pageContent} [${JSON.stringify(doc.metadata, null)}]`);
}
```

```output
* The powerhouse of the cell is the mitochondria [{"source":"https://example.com"}]
* Mitochondria are made out of lipids [{"source":"https://example.com"}]
```

유사도 검색을 실행하고 해당 점수를 받으려면 다음을 실행할 수 있습니다:

```typescript
const similaritySearchWithScoreResults = await vectorStore.similaritySearchWithScore("biology", 2, filter)

for (const [doc, score] of similaritySearchWithScoreResults) {
  console.log(`* [SIM=${score.toFixed(3)}] ${doc.pageContent} [${JSON.stringify(doc.metadata)}]`);
}
```

```output
* [SIM=0.835] The powerhouse of the cell is the mitochondria [{"source":"https://example.com"}]
* [SIM=0.852] Mitochondria are made out of lipids [{"source":"https://example.com"}]
```

### Hybrid Search

Weaviate에서 `Hybrid search`는 벡터 검색과 키워드(BM25F) 검색의 결과를 두 결과 세트를 융합하여 결합합니다. 키워드 및 벡터 구성 요소의 상대적 가중치를 변경하려면 쿼리에서 `alpha` 값을 설정하세요.

hybrid search 옵션의 전체 목록은 **[문서](https://weaviate.io/developers/weaviate/search/hybrid)**를 확인하세요.

```typescript
const results = await vectorStore.hybridSearch("biology",
  {
    limit: 1,
    alpha: 0.25,
    targetVector: ["title"],
    rerank: {
      property: "title",
      query: "greeting",
    },
});
```

### Retrieval Augmented Generation (RAG)

Retrieval Augmented Generation (RAG)은 정보 검색과 생성형 AI 모델을 결합합니다.

Weaviate에서 RAG 쿼리는 두 부분으로 구성됩니다: 검색 쿼리와 모델을 위한 프롬프트입니다. Weaviate는 먼저 검색을 수행한 다음 검색 결과와 프롬프트를 모두 생성형 AI 모델에 전달한 후 생성된 응답을 반환합니다.

- @param query 검색할 쿼리입니다.
- @param options hybrid search를 수행하기 위한 사용 가능한 옵션
- @param generate 생성을 위한 사용 가능한 옵션. 전체 목록은 문서를 확인하세요

```typescript
const results = await vectorStore.generate("hello world",
    {
        singlePrompt: {
            prompt: "Translate this into German: {title}",
        },
        config: generativeParameters.openAI({
            model: "gpt-3.5-turbo",
        }),
    },
    {
        limit: 2,
        targetVector: ["title"],
    }
);
```

### retriever로 변환하여 쿼리

vector store를 [retriever](/oss/javascript/langchain/retrieval)로 변환하여 chain에서 더 쉽게 사용할 수도 있습니다.

```typescript
const retriever = vectorStore.asRetriever({
  // Optional filter
  filter: filter,
  k: 2,
});
await retriever.invoke("biology");
```

```output
[
  Document {
    pageContent: 'The powerhouse of the cell is the mitochondria',
    metadata: { source: 'https://example.com' },
    id: undefined
  },
  Document {
    pageContent: 'Mitochondria are made out of lipids',
    metadata: { source: 'https://example.com' },
    id: undefined
  }
]
```

### retrieval-augmented generation 사용법

retrieval-augmented generation (RAG)을 위해 이 vector store를 사용하는 방법에 대한 가이드는 다음 섹션을 참조하세요:

- [LangChain으로 RAG 앱 구축하기](/oss/javascript/langchain/rag)
- [Agentic RAG](/oss/javascript/langgraph/agentic-rag)
- [Retrieval 문서](/oss/javascript/langchain/retrieval)

## API reference

모든 `WeaviateStore` 기능 및 구성에 대한 자세한 문서는 [API reference](https://api.js.langchain.com/classes/langchain_weaviate.WeaviateStore.html)를 참조하세요.

---

<Callout icon="pen-to-square" iconType="regular">
    [Edit the source of this page on GitHub.](https://github.com/langchain-ai/docs/edit/main/src/oss/javascript/integrations/vectorstores/weaviate.mdx)
</Callout>
<Tip icon="terminal" iconType="regular">
    [Connect these docs programmatically](/use-these-docs) to Claude, VSCode, and more via MCP for    real-time answers.
</Tip>
